<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Luv__Buffer (luv.Luv__Buffer)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">luv</a> &#x00BB; Luv__Buffer</nav><h1>Module <code>Luv__Buffer</code></h1><p>Data buffers.</p><nav class="toc"><ul><li><a href="#basics">Basics</a></li><li><a href="#conversions">Conversions</a></li><li><a href="#converting-blits">Converting blits</a></li><li><a href="#lists-of-buffers">Lists of buffers</a></li></ul></nav></header><section><header><h2 id="basics"><a href="#basics" class="anchor"></a>Basics</h2></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = <span><span>(char, Stdlib.Bigarray.int8_unsigned_elt, Stdlib.Bigarray.c_layout)</span> Stdlib.Bigarray.Array1.t</span></code></dt><dd><p>Buffers with C storage.</p><p>These are OCaml bigstrings (<code>char</code> bigarrays). Roughly speaking, they correspond to C buffers referenced by pointers of type <code>char*</code>, but also know their own size.</p><p>In addition to being usable with the functions in this module, the type is compatible with at least the following libraries:</p><ul><li><a href="https://caml.inria.fr/pub/docs/manual-ocaml/libref/Bigarray.Array1.html"><code>Bigarray</code></a> from OCaml's standard library</li><li><a href="https://ocsigen.org/lwt/dev/api/Lwt_bytes"><code>Lwt_bytes</code></a> from Lwt</li><li><a href="https://github.com/inhabitedtype/bigstringaf">bigstringaf</a></li><li><a href="https://github.com/c-cube/ocaml-bigstring">ocaml-bigstring</a></li></ul></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Allocates a fresh buffer of the given size.</p></dd></dl><dl><dt class="spec value" id="val-size"><a href="#val-size" class="anchor"></a><code><span class="keyword">val</span> size : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Evaluates to the size of the given buffer.</p></dd></dl><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val</span> get : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> char</code></dt><dd><p><code>Luv.Buffer.get buffer index</code> retrieves the character in <code>buffer</code> at <code>index</code>.</p><p>Can also be written as <code>buffer.{index}</code>.</p></dd></dl><dl><dt class="spec value" id="val-unsafe_get"><a href="#val-unsafe_get" class="anchor"></a><code><span class="keyword">val</span> unsafe_get : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> char</code></dt><dd><p>Like <a href="../Luv/Buffer/index.html#val-get"><code>Luv.Buffer.get</code></a>, but does not perform a bounds check.</p></dd></dl><dl><dt class="spec value" id="val-set"><a href="#val-set" class="anchor"></a><code><span class="keyword">val</span> set : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> char <span>&#45;&gt;</span> unit</code></dt><dd><p><code>Luv.Buffer.set buffer index value</code> sets the character in <code>buffer</code> at <code>index</code> to <code>value</code>.</p><p>Can also be written as <code>buffer.{index} &lt;- value</code>.</p></dd></dl><dl><dt class="spec value" id="val-unsafe_set"><a href="#val-unsafe_set" class="anchor"></a><code><span class="keyword">val</span> unsafe_set : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> char <span>&#45;&gt;</span> unit</code></dt><dd><p>Like <a href="../Luv/Buffer/index.html#val-set"><code>Luv.Buffer.set</code></a>, but does not perform a bounds check.</p></dd></dl><dl><dt class="spec value" id="val-sub"><a href="#val-sub" class="anchor"></a><code><span class="keyword">val</span> sub : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>offset:int</span> <span>&#45;&gt;</span> <span>length:int</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>Luv.Buffer.sub buffer ~offset ~length</code> creates a view into <code>buffer</code> that starts at the given offset and has the given length.</p><p>No data is copied.</p></dd></dl><dl><dt class="spec value" id="val-blit"><a href="#val-blit" class="anchor"></a><code><span class="keyword">val</span> blit : <span>source:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>destination:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Copies data from <code>source</code> to <code>destination</code>.</p><p>The amount of data copied is the minimum of the two buffers' size.</p><p>To copy part of a buffer, use <a href="../Luv/Buffer/index.html#val-sub"><code>Luv.Buffer.sub</code></a> to create a view, and pass the view to <code>Luv.Buffer.blit</code>.</p></dd></dl><dl><dt class="spec value" id="val-fill"><a href="#val-fill" class="anchor"></a><code><span class="keyword">val</span> fill : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> unit</code></dt><dd><p>Fills the given buffer with the given character.</p></dd></dl></section><section><header><h2 id="conversions"><a href="#conversions" class="anchor"></a>Conversions</h2></header><dl><dt class="spec value" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span class="keyword">val</span> to_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Creates a string with the same contents as the given buffer.</p></dd></dl><dl><dt class="spec value" id="val-to_bytes"><a href="#val-to_bytes" class="anchor"></a><code><span class="keyword">val</span> to_bytes : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bytes</code></dt><dd><p>Creates a <code>bytes</code> buffer with the same contents as the given buffer.</p></dd></dl><dl><dt class="spec value" id="val-from_string"><a href="#val-from_string" class="anchor"></a><code><span class="keyword">val</span> from_string : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Creates a buffer from a string.</p></dd></dl><dl><dt class="spec value" id="val-from_bytes"><a href="#val-from_bytes" class="anchor"></a><code><span class="keyword">val</span> from_bytes : bytes <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Creates a buffer from <code>bytes</code>.</p></dd></dl></section><section><header><h2 id="converting-blits"><a href="#converting-blits" class="anchor"></a>Converting blits</h2></header><dl><dt class="spec value" id="val-blit_to_bytes"><a href="#val-blit_to_bytes" class="anchor"></a><code><span class="keyword">val</span> blit_to_bytes : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bytes <span>&#45;&gt;</span> <span>destination_offset:int</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Copies data from a buffer to a <code>bytes</code> buffer.</p></dd></dl><dl><dt class="spec value" id="val-blit_from_bytes"><a href="#val-blit_from_bytes" class="anchor"></a><code><span class="keyword">val</span> blit_from_bytes : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bytes <span>&#45;&gt;</span> <span>source_offset:int</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Copies data from a <code>bytes</code> buffer to a buffer.</p></dd></dl><dl><dt class="spec value" id="val-blit_from_string"><a href="#val-blit_from_string" class="anchor"></a><code><span class="keyword">val</span> blit_from_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>source_offset:int</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Copies data from a string to a buffer.</p></dd></dl></section><section><header><h2 id="lists-of-buffers"><a href="#lists-of-buffers" class="anchor"></a>Lists of buffers</h2><p>Many Luv functions, such as <a href="../Luv/File/index.html#val-write"><code>Luv.File.write</code></a>, work with lists of buffers (i.e., they do scatter-gather I/O). These are helpers for working with buffer lists.</p></header><dl><dt class="spec value" id="val-total_size"><a href="#val-total_size" class="anchor"></a><code><span class="keyword">val</span> total_size : <span><a href="index.html#type-t">t</a> list</span> <span>&#45;&gt;</span> int</code></dt><dd><p>Evaluates to the sum of the sizes of the buffers in the list.</p></dd></dl><dl><dt class="spec value" id="val-drop"><a href="#val-drop" class="anchor"></a><code><span class="keyword">val</span> drop : <span><a href="index.html#type-t">t</a> list</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> list</span></code></dt><dd><p><code>drop buffers count</code> drops the first <code>count</code> bytes from <code>buffers</code>.</p><p>For example, if <code>buffers</code> contains two buffers of size 16, <code>drop buffers
    18</code> will evaluate to a list that has lost the reference to the first buffer, and contains only a view into the second buffer of size 14.</p></dd></dl></section></div></body></html>